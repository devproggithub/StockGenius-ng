<div class="content-wrapper" style="margin-top: 85px !important;">
    <div class="container-full">
      <!-- Content Header (Page header) -->
      <div class="content-header">
          <div class="d-block align-items-center">
              <div class="me-auto">
                  <h3 class="page-title">Clients/Comptes</h3>
                  <div class="d-inline-block align-items-center" style="float: inline-end;">
                    <button class="waves-effect waves-light btn btn-social btn-foursquare mb-5" data-bs-toggle="modal" data-bs-target="#modal-right">
                        <i class="fa fa-add"></i> Nouveau client
                      </button>
                      <!-- <nav>
                          <ol class="breadcrumb">
                              <li class="breadcrumb-item"><a href="#"><i class="mdi mdi-home-outline"></i></a></li>
                              <li class="breadcrumb-item" aria-current="page">Tables</li>
                              <li class="breadcrumb-item active" aria-current="page">Data Tables</li>
                          </ol>
                      </nav> -->
                  </div>
              </div>
          </div>
      </div>

      <!-- Main content -->
      <section class="content">
        <div class="row">
            <div class="col-12">
                <div class="box">
                    <!-- <div class="box-header with-border">
                      <h3 class="box-title">Hover Export Data Table</h3>
                      <h6 class="box-subtitle">Export data to Copy, CSV, Excel, PDF & Print</h6>
                    </div> -->
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="table-responsive">
                            <!-- <table id="example" class="table table-bordered table-hover display nowrap margin-top-10 w-p100" *ngIf="!isLoading">
                                <thead>
                                  <tr>
                                    <th>Raison sociale</th>
                                    <th>N° Téléphone</th>
                                    <th>Adresse mail</th>
                                    <th>Adresse postale</th>
                                    <th>Date d'ajout</th>
                                    <th>Dernière opération</th>
                                    <th>Actions</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let customer of customers">
                                    <td>{{ customer.name }}</td>
                                    <td>{{ customer.phone }}</td>
                                    <td>{{ customer.email }}</td>
                                    <td>{{ customer.address }}, {{ customer.city }}</td>
                                    <td>{{ formatDate(customer.added_at) }}</td>
                                    <td>---</td>
                                    <td>
                                      <div class="clearfix">
                                        <button class="waves-effect waves-circle btn btn-social-icon btn-circle btn-bitbucket"><i class="fa fa-eye"></i></button>
                                        <button class="waves-effect waves-circle btn btn-social-icon btn-circle btn-dropbox"><i class="fa fa-edit"></i></button>
                                        <button class="waves-effect waves-circle btn btn-social-icon btn-circle btn-google"><i class="fa fa-trash"></i></button>
                                      </div>
                                    </td>
                                  </tr>
                                </tbody>
                            </table> -->
                            <table id="example" class="table table-bordered table-hover display nowrap margin-top-10 w-p100" *ngIf="!isLoading">
                                <thead>
                                    <tr>
                                        <th>Raison sociale</th>
                                        <th>N° Téléphone</th>
                                        <th>Adresse mail</th>
                                        <th>Adresse postale</th>
                                        <th>Date d'ajout</th>
                                        <th>Dernière opération</th>
                                        <!-- <th>Actions</th> -->
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let customer of customers">
                                        <td>{{ customer.name }}
                                            <span *ngIf="customer.customer_type" class="badge" style="float: right;"
                                                [ngClass]="{'bg-success': customer.customer_type === 'grossiste', 
                                                            'bg-info': customer.customer_type === 'particulier'}">
                                            {{ customer.customer_type === 'grossiste' ? 'Grossiste' : 'Particulier' }}
                                            </span>
                                        </td>
                                        <td>{{ customer.phone }}</td>
                                        <td>{{ customer.email }}</td>
                                        <td>{{ customer.address }}, {{ customer.city }}</td>
                                        <td>{{ customer.added_at | date : 'dd/MM/yyyy - HH:mm'}}</td>
                                        <td>---</td>
                                        <!-- <td>
                                            <div class="clearfix">
                                                <button class="waves-effect waves-circle btn btn-social-icon btn-circle btn-bitbucket"><i class="fa fa-eye"></i></button>
                                                <button class="waves-effect waves-circle btn btn-social-icon btn-circle btn-dropbox"><i class="fa fa-edit"></i></button>
                                                <button class="waves-effect waves-circle btn btn-social-icon btn-circle btn-google"><i class="fa fa-trash"></i></button>
                                            </div>
                                        </td> -->
                                    </tr>
                                </tbody>
                            </table>
                              <!-- Message d'erreur -->
                              <div *ngIf="error" class="alert alert-danger">
                                {{ error }}
                              </div>
                              
                              <!-- Indicateur de chargement -->
                              <div *ngIf="isLoading" class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                  <span class="sr-only">Chargement...</span>
                                </div>
                              </div>
                        </div>              
                    </div>
                    <!-- /.box-body -->
                  </div>
            </div>
        </div>
    </section>
    <!-- /.content -->
  
  </div>
   <!-- Modal new customer -->
   <div class="modal modal-right fade" id="modal-right" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Nouveau client</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col">
              <form [formGroup]="customerForm" (ngSubmit)="addCustomer()" novalidate>
                <div class="row">
                  <div class="col-12">
                    <div class="form-group">
                      <h5>Raison sociale <span class="text-danger">*</span></h5>
                      <div class="controls">
                        <input type="text" formControlName="name" class="form-control" placeholder="Saisir la raison sociale"
                               [ngClass]="{'is-invalid': submitted && f['name'].errors}">
                        <div *ngIf="submitted && f['name'].errors" class="invalid-feedback">
                          <div *ngIf="f['name'].hasError('required')">La raison sociale est obligatoire</div>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <h5>Adresse email <span class="text-danger">*</span></h5>
                      <div class="controls">
                        <input type="email" formControlName="email" class="form-control" placeholder="Saisir l'adresse email"
                               [ngClass]="{'is-invalid': submitted && f['email'].errors}">
                        <div *ngIf="submitted && f['email'].errors" class="invalid-feedback">
                          <div *ngIf="f['email'].hasError('required')">L'adresse email est obligatoire</div>
                          <div *ngIf="f['email'].hasError('email')">Format d'email invalide</div>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <h5>N° Téléphone <span class="text-danger">*</span></h5>
                      <div class="input-group">
                        <input type="text" formControlName="phone" class="form-control" placeholder="Saisir le N° de téléphone"
                               [ngClass]="{'is-invalid': submitted && f['phone'].errors}">
                        <div *ngIf="submitted && f['phone'].errors" class="invalid-feedback">
                          <div *ngIf="f['phone'].hasError('required')">Le numéro de téléphone est obligatoire</div>
                          <div *ngIf="f['phone'].hasError('pattern')">Format de téléphone invalide</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="form-group">
                      <h5>Ville <span class="text-danger">*</span></h5>
                      <div class="controls">
                        <select formControlName="city" class="form-select"
                                [ngClass]="{'is-invalid': submitted && f['city'].errors}">
                          <option value="">Sélectionnez la ville</option>
                          <option value="Casablanca">Casablanca</option>
                          <option value="Rabat">Rabat</option>
                          <option value="Kenitra">Kenitra</option>
                          <option value="Marrakech">Marrakech</option>
                          <option value="Agadir">Agadir</option>
                        </select>
                        <div *ngIf="submitted && f['city'].errors" class="invalid-feedback">
                          <div *ngIf="f['city'].hasError('required')">La ville est obligatoire</div>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <h5>Adresse postale <span class="text-danger">*</span></h5>
                      <div class="controls">
                        <textarea formControlName="address" class="form-control" placeholder="Adresse complète"
                                  [ngClass]="{'is-invalid': submitted && f['address'].errors}"></textarea>
                        <div *ngIf="submitted && f['address'].errors" class="invalid-feedback">
                          <div *ngIf="f['address'].hasError('required')">L'adresse postale est obligatoire</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <h5>Type client <span class="text-danger">*</span></h5>
                      <div [ngClass]="{'is-invalid': submitted && f['clientType'].errors}">
                        <fieldset class="controls">
                          <input formControlName="clientType" type="radio" id="radio_1" value="grossiste">
                          <label for="radio_1">Grossiste</label>
                        </fieldset>
                        <fieldset>
                          <input formControlName="clientType" type="radio" id="radio_2" value="particulier">
                          <label for="radio_2">Particulier</label>
                        </fieldset>
                      </div>
                      <div *ngIf="submitted && f['clientType'].errors" class="invalid-feedback">
                        <div *ngIf="f['clientType'].hasError('required')">Le type de client est obligatoire</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- <div *ngIf="errorMessage" class="alert alert-danger mt-3">
                  {{ errorMessage }}
                </div> -->
                
                <div class="text-xs-right">
                  <div class="row d-flex">
                    <div>
                      <button type="submit" class="btn btn-info" style="width: inherit;" 
                      >Ajouter</button>
                    </div>
                  </div>
                  <div class="row d-flex">
                    <div class="col-md-12">
                      <button type="button" class="btn btn-default" data-bs-dismiss="modal" style="width: inherit;">Annuler</button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<!-- /.modal -->
</div>